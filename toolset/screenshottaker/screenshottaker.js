/**
 * Simple phantomjs script to make a simple screenshot of a given page and save it to a given file.
 */

var system = require('system');
var args = system.args;

if (args.length <= 2) {
    console.log('I need an url (input) and an imagefile (output)!');
    phantom.exit();
}

var url = args[1];
var imagefile = args[2];

var page = require('webpage').create();

page.viewportSize = {width: 1366, height: 768};
page.clipRect = {top: 0, left: 0, width: 1366, height: 768};
page.settings.userAgent = 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2227.0 Safari/537.36';
page.settings.resourceTimeout = 5000;

page.open(url);

page.onLoadFinished = function(status) {

    if ( status !== 'success' ) {
        console.log( 'Unable to load the address!' );
        phantom.exit();
    } else {
        page.render(imagefile, {format: 'jpeg', quality: '50'});
        phantom.exit();
    }
};


